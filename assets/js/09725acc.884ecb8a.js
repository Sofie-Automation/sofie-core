"use strict";(self.webpackChunksofie_documentation=self.webpackChunksofie_documentation||[]).push([[3129],{61668:(e,o,i)=>{i.r(o),i.d(o,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>n,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"for-developers/npm-package-publishing","title":"NPM Package Publishing","description":"While many parts of Sofie reside in the main sofie-core mono-repo, there are a few NPM libraries in that repo which want to be published to NPM to allow being consumed elsewhere.","source":"@site/docs/for-developers/npm-package-publishing.md","sourceDirName":"for-developers","slug":"/for-developers/npm-package-publishing","permalink":"/sofie-core/docs/for-developers/npm-package-publishing","draft":false,"unlisted":false,"editUrl":"https://github.com/Sofie-Automation/sofie-core/edit/main/packages/documentation/docs/for-developers/npm-package-publishing.md","tags":[],"version":"current","sidebarPosition":999,"frontMatter":{"title":"NPM Package Publishing","sidebar_position":999},"sidebar":"forDevelopers","previous":{"title":"MOS-plugins","permalink":"/sofie-core/docs/for-developers/mos-plugins"}}');var r=i(62540),t=i(43023);const n={title:"NPM Package Publishing",sidebar_position:999},a=void 0,l={},h=[];function c(e){const o={a:"a",br:"br",code:"code",li:"li",p:"p",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(o.p,{children:["While many parts of Sofie reside in the main ",(0,r.jsx)(o.code,{children:"sofie-core"})," mono-repo, there are a few NPM libraries in that repo which want to be published to NPM to allow being consumed elsewhere."]}),"\n",(0,r.jsx)(o.p,{children:"Many features and PRs will need to make changes to these libraries, which means that you will often need to publish testing versions that you can use before your PR is merged, or when you need to publish your own Sofie releases to backport that feature onto an older release."}),"\n",(0,r.jsxs)(o.p,{children:["To make this easy, the Github actions workflows have been structured so that you can utilise them with minimal effort for publishing to your own npm organization.",(0,r.jsx)(o.br,{}),"\n","The ",(0,r.jsx)(o.code,{children:"Publish libraries"})," workflow is the single workflow used to perform this publishing, for both stable and prerelease versions. You can manually trigger this workflow at any time in the Github UI or via CLI tools to trigger a prerelease build of the libraries."]}),"\n",(0,r.jsxs)(o.p,{children:["When running in your fork, this workflow will only run if the ",(0,r.jsx)(o.code,{children:"NPM_PACKAGE_PREFIX"})," variable has been defined (Note: this is a variable not a secret)."]}),"\n",(0,r.jsx)(o.p,{children:"Recommended repository variables/secrets"}),"\n",(0,r.jsxs)(o.ul,{children:["\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.code,{children:"NPM_PACKAGE_PREFIX"})," \u2014 repository variable; your npm organisation (required for forks to publish)."]}),"\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.code,{children:"NPM_PACKAGE_SCOPE"})," \u2014 repository variable; optional, adds ",(0,r.jsx)(o.code,{children:"sofie-"})," prefix to package names."]}),"\n",(0,r.jsxs)(o.li,{children:[(0,r.jsx)(o.code,{children:"NPM_TOKEN"})," \u2014 repository secret; optional if using trusted publishing, otherwise required for the workflow to publish."]}),"\n"]}),"\n",(0,r.jsxs)(o.p,{children:["For the publishing, we recommend enabling ",(0,r.jsx)(o.a,{href:"https://docs.npmjs.com/trusted-publishers",children:"trusted publishing"}),", but in case you are unable to do this (or to allow for the first publish), if you provide a ",(0,r.jsx)(o.code,{children:"NPM_TOKEN"})," secret, that will be used for the publishing instead."]}),"\n",(0,r.jsxs)(o.p,{children:["The ",(0,r.jsx)(o.a,{href:"https://github.com/Sofie-Automation/sofie-timeline-state-resolver",children:(0,r.jsx)(o.code,{children:"timeline-state-resolver"})})," repository has been setup in the same way, as this is another library that you will often need to publish your own versions for."]})]})}function d(e={}){const{wrapper:o}={...(0,t.R)(),...e.components};return o?(0,r.jsx)(o,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},43023:(e,o,i)=>{i.d(o,{R:()=>n,x:()=>a});var s=i(63696);const r={},t=s.createContext(r);function n(e){const o=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function a(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:n(e.components),s.createElement(t.Provider,{value:o},e.children)}}}]);
"use strict";(self.webpackChunksofie_documentation=self.webpackChunksofie_documentation||[]).push([[7089],{36466:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"user-guide/installation/installing-sofie-server-core","title":"Quick install","description":"Installing for testing \\\\(or production\\\\)","source":"@site/docs/user-guide/installation/installing-sofie-server-core.md","sourceDirName":"user-guide/installation","slug":"/user-guide/installation/installing-sofie-server-core","permalink":"/sofie-core/docs/user-guide/installation/installing-sofie-server-core","draft":false,"unlisted":false,"editUrl":"https://github.com/Sofie-Automation/sofie-core/edit/main/packages/documentation/docs/user-guide/installation/installing-sofie-server-core.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"userGuide","previous":{"title":"Getting Started","permalink":"/sofie-core/docs/user-guide/installation/intro"},"next":{"title":"Initial Sofie Core Setup","permalink":"/sofie-core/docs/user-guide/installation/initial-sofie-core-setup"}}');var i=o(62540),s=o(43023);const r={sidebar_position:2},a="Quick install",l={},d=[{value:"Installing for testing (or production)",id:"installing-for-testing-or-production",level:2},{value:"<strong>Prerequisites</strong>",id:"prerequisites",level:3},{value:"Installation",id:"installation",level:3},{value:"Tips for running in production",id:"tips-for-running-in-production",level:3},{value:"Installing for Development",id:"installing-for-development",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"quick-install",children:"Quick install"})}),"\n",(0,i.jsx)(n.h2,{id:"installing-for-testing-or-production",children:"Installing for testing (or production)"}),"\n",(0,i.jsx)(n.h3,{id:"prerequisites",children:(0,i.jsx)(n.strong,{children:"Prerequisites"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Linux"}),": Install ",(0,i.jsx)(n.a,{href:"https://docs.docker.com/install/linux/docker-ce/ubuntu/",children:"Docker"})," and ",(0,i.jsx)(n.a,{href:"https://www.digitalocean.com/community/tutorials/how-to-install-docker-compose-on-ubuntu-18-04",children:"docker-compose"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Windows"}),": Install ",(0,i.jsx)(n.a,{href:"https://hub.docker.com/editions/community/docker-ce-desktop-windows",children:"Docker for Windows"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"installation",children:"Installation"}),"\n",(0,i.jsxs)(n.p,{children:["This docker-compose file automates the basic setup of the ",(0,i.jsx)(n.a,{href:"/sofie-core/docs/for-developers/libraries#main-application",children:"Sofie-Core application"}),", the backend database and different Gateway options."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"# This is NOT recommended to be used for a production deployment.\n# It aims to quickly get an evaluation version of Sofie running and serve as a basis for how to set up a production deployment.\nservices:\n  db:\n    hostname: mongo\n    image: mongo:6.0\n    restart: always\n    entrypoint: ['/usr/bin/mongod', '--replSet', 'rs0', '--bind_ip_all']\n    # the healthcheck avoids the need to initiate the replica set\n    healthcheck:\n      test: test $$(mongosh --quiet --eval \"try {rs.initiate()} catch(e) {rs.status().ok}\") -eq 1\n      interval: 10s\n      start_period: 30s\n    ports:\n      - '27017:27017'\n    volumes:\n      - db-data:/data/db\n    networks:\n      - sofie\n\n  # Fix Ownership Snapshots mount\n  # Because docker volumes are owned by root by default\n  # And our images follow best-practise and don't run as root\n  change-vol-ownerships:\n    image: node:22-alpine\n    user: 'root'\n    volumes:\n      - sofie-store:/mnt/sofie-store\n    entrypoint: ['sh', '-c', 'chown -R node:node /mnt/sofie-store']\n\n  core:\n    hostname: core\n    image: sofietv/tv-automation-server-core:release52\n    restart: always\n    ports:\n      - '3000:3000' # Same port as meteor uses by default\n    environment:\n      PORT: '3000'\n      MONGO_URL: 'mongodb://db:27017/meteor'\n      MONGO_OPLOG_URL: 'mongodb://db:27017/local'\n      ROOT_URL: 'http://localhost:3000'\n      SOFIE_STORE_PATH: '/mnt/sofie-store'\n    networks:\n      - sofie\n    volumes:\n      - sofie-store:/mnt/sofie-store\n    depends_on:\n      change-vol-ownerships:\n        condition: service_completed_successfully\n      db:\n        condition: service_healthy\n\n  playout-gateway:\n    image: sofietv/tv-automation-playout-gateway:release52\n    restart: always\n    environment:\n      DEVICE_ID: playoutGateway0\n      CORE_HOST: core\n      CORE_PORT: '3000'\n    networks:\n      - sofie\n      - lan_access\n    depends_on:\n      - core\n\n  # Choose one of the following images, depending on which type of ingest gateway is wanted.\n\n  # spreadsheet-gateway:\n  #   image: superflytv/sofie-spreadsheet-gateway:latest\n  #   restart: always\n  #   environment:\n  #     DEVICE_ID: spreadsheetGateway0\n  #     CORE_HOST: core\n  #     CORE_PORT: '3000'\n  #   networks:\n  #     - sofie\n  #   depends_on:\n  #     - core\n\n  # mos-gateway:\n  #   image: sofietv/tv-automation-mos-gateway:release52\n  #   restart: always\n  #   ports:\n  #     - \"10540:10540\" # MOS Lower port\n  #     - \"10541:10541\" # MOS Upper port\n  #     # - \"10542:10542\" # MOS query port - not used\n  #   environment:\n  #     DEVICE_ID: mosGateway0\n  #     CORE_HOST: core\n  #     CORE_PORT: '3000'\n  #   networks:\n  #     - sofie\n  #   depends_on:\n  #     - core\n\n  # inews-gateway:\n  #   image: tv2media/inews-ftp-gateway:1.37.0-in-testing.20\n  #   restart: always\n  #   command: yarn start -host core -port 3000 -id inewsGateway0\n  #   networks:\n  #     - sofie\n  #   depends_on:\n  #     - core\n\n  # rundown-editor:\n  #   image: ghcr.io/superflytv/sofie-automation-rundown-editor:v2.2.4\n  #   restart: always\n  #   ports:\n  #   \t- '3010:3010'\n  #   environment:\n  #     PORT: '3010'\n  #   networks:\n  #     - sofie\n  #   depends_on:\n  #     - core\n\nnetworks:\n  sofie:\n  lan_access:\n    driver: bridge\n\nvolumes:\n  db-data:\n  sofie-store:\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Create a ",(0,i.jsx)(n.code,{children:"Sofie"})," folder, copy the above content, and save it as ",(0,i.jsx)(n.code,{children:"docker-compose.yaml"})," within the ",(0,i.jsx)(n.code,{children:"Sofie"})," folder."]}),"\n",(0,i.jsxs)(n.p,{children:["Visit ",(0,i.jsx)(n.a,{href:"/sofie-core/docs/user-guide/installation/installing-a-gateway/rundown-or-newsroom-system-connection/intro",children:"Rundowns\xa0&\xa0Newsroom Systems"})," to see which ",(0,i.jsx)(n.em,{children:"Ingest Gateway"})," can be used in your specific production environment. If you don't have an NRCS that you would like to integrate with, you can use the ",(0,i.jsx)(n.a,{href:"rundown-editor",children:"Rundown Editor"})," as a simple Rundown creation utility. Navigate to the ",(0,i.jsx)(n.em,{children:"ingest-gateway"})," section of ",(0,i.jsx)(n.code,{children:"docker-compose.yaml"})," and select which type of ",(0,i.jsx)(n.em,{children:"ingest-gateway"})," you'd like installed by uncommenting it. Save your changes."]}),"\n",(0,i.jsxs)(n.p,{children:["Open a terminal, execute ",(0,i.jsx)(n.code,{children:"cd Sofie"})," and ",(0,i.jsx)(n.code,{children:"sudo docker-compose up"})," (or just ",(0,i.jsx)(n.code,{children:"docker-compose up"})," on Windows). This will download MongoDB and Sofie components' container images and start them up. The installation will be done when your terminal window will be filled with messages coming from ",(0,i.jsx)(n.code,{children:"playout-gateway_1"})," and ",(0,i.jsx)(n.code,{children:"core_1"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Once the installation is done, Sofie should be running on ",(0,i.jsx)(n.a,{href:"http://localhost:3000",children:"http://localhost:3000"}),". Next, you need to make sure that the Playout Gateway and Ingest Gateway are connected to the default Studio that has been automatically created. Open the Sofie User Interface with ",(0,i.jsx)(n.a,{href:"../features/access-levels#browser-based",children:"Configuration Access level"})," by opening ",(0,i.jsx)(n.a,{href:"http://localhost:3000/?admin=1",children:"http://localhost:3000/?admin=1"})," in your Web Browser and navigate to ",(0,i.jsx)(n.em,{children:"Settings"}),"\xa0\ud83e\udc52 ",(0,i.jsx)(n.em,{children:"Studios"}),"\xa0\ud83e\udc52 ",(0,i.jsx)(n.em,{children:"Default Studio"}),"\xa0\ud83e\udc52 ",(0,i.jsx)(n.em,{children:"Peripheral Devices"}),". In the ",(0,i.jsx)(n.em,{children:"Parent Devices"})," section, create a new Device using the ",(0,i.jsx)(n.strong,{children:"+"})," button, rename the device to ",(0,i.jsx)(n.em,{children:"Playout Gateway"})," and select ",(0,i.jsx)(n.em,{children:"Playout gateway"})," from the ",(0,i.jsx)(n.em,{children:"Peripheral Device"})," drop down menu. Repeat this process for your ",(0,i.jsx)(n.em,{children:"Ingest Gateway"})," or ",(0,i.jsx)(n.em,{children:"Sofie Rundown Editor"}),"."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["Starting with Sofie version 1.52.0, ",(0,i.jsx)(n.code,{children:"sofietv"})," container images will run as UID 1000."]})}),"\n",(0,i.jsx)(n.h3,{id:"tips-for-running-in-production",children:"Tips for running in production"}),"\n",(0,i.jsxs)(n.p,{children:["There are some things not covered in this guide needed to run ",(0,i.jsx)(n.em,{children:"Sofie"})," in a production environment:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Logging: Collect, store and track error messages. ",(0,i.jsx)(n.a,{href:"https://www.elastic.co/kibana",children:"Kibana"})," and ",(0,i.jsx)(n.a,{href:"https://www.elastic.co/logstash",children:"logstash"})," is one way to do it."]}),"\n",(0,i.jsxs)(n.li,{children:["NGINX: It is customary to put a load-balancer in front of ",(0,i.jsx)(n.em,{children:"Sofie\xa0Core"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"Memory and CPU usage monitoring."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"installing-for-development",children:"Installing for Development"}),"\n",(0,i.jsx)(n.p,{children:"Installation instructions for installing Sofie-Core or the various gateways are available in the README file in their respective github repos."}),"\n",(0,i.jsxs)(n.p,{children:["Common prerequisites are ",(0,i.jsx)(n.a,{href:"https://nodejs.org/",children:"Node.js"})," and ",(0,i.jsx)(n.a,{href:"https://yarnpkg.com/",children:"Yarn"}),".\nLinks to the repos are listed at ",(0,i.jsx)(n.a,{href:"/sofie-core/docs/for-developers/libraries",children:"Applications & Libraries"}),"."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.a,{href:"https://github.com/Sofie-Automation/sofie-core",children:[(0,i.jsx)(n.em,{children:"Sofie\xa0Core"})," GitHub Page for Developers"]})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},43023:(e,n,o)=>{o.d(n,{R:()=>r,x:()=>a});var t=o(63696);const i={},s=t.createContext(i);function r(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);
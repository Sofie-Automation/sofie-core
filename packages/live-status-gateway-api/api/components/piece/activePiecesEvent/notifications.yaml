title: Notifications
description: Active notifications in Sofie

$defs:
  notifications:
    type: object
    title: NotificationsEvent
    properties:
      event:
        type: string
        const: notifications
      activeNotifications:
        description: Active notifications in Sofie
        type: array
        items:
          $ref: '#/$defs/NotificationObj'
    required: [event, activeNotifications]
    additionalProperties: false
    examples:
      - event: notifications
        activeNotifications:
          - $ref: '#/$defs/NotificationObj/examples/0'

  NotificationObj:
    type: object
    title: NotificationObj
    description: This describes a notification that should be shown to a user. These can come from various sources, and are added and removed dynamically during system usage
    required:
      - _id
      - severity
      - message
      - relatedTo
      - created
    properties:
      _id:
        type: string
        description: Unique identifier for the notification
      severity:
        $ref: '#/$defs/severity'
      message:
        type: string
        description: The message of the notification
      relatedTo:
        $ref: '#/$defs/NotificationTarget'
      created:
        type: integer
        format: int64
        description: Unix timestamp of creation
      modified:
        type: integer
        format: int64
        description: Unix timestamp of last modification
    additionalProperties: false
    examples:
      - _id: 'notif123'
        severity: error
        message: 'disk.space.low'
        relatedTo:
          $ref: '#/$defs/NotificationTarget/examples/0'
        created: 1694784932
        modified: 1694784950

  severity:
    type: string
    title: NotificationSeverity
    description: Severity level of the notification.
    enum:
      - warning
      - error
      - info
    examples:
      - info

  NotificationTarget:
    title: NotificationTarget
    description: Description of what the notification is related to
    oneOf:
      - $ref: '#/$defs/NotificationTargetRundown'
      - $ref: '#/$defs/NotificationTargetRundownPlaylist'
      - $ref: '#/$defs/NotificationTargetPartInstance'
      - $ref: '#/$defs/NotificationTargetPieceInstance'
      - $ref: '#/$defs/NotificationTargetUnknown'
    examples:
      - $ref: '#/$defs/NotificationTargetRundown/examples/0'
      - $ref: '#/$defs/NotificationTargetRundownPlaylist/examples/0'
      - $ref: '#/$defs/NotificationTargetPartInstance/examples/0'
      - $ref: '#/$defs/NotificationTargetPieceInstance/examples/0'
      - $ref: '#/$defs/NotificationTargetUnknown/examples/0'

  NotificationTargetType:
    type: string
    title: NotificationTargetType
    description: Possible NotificationTarget types
    enum:
      - rundown
      - playlist
      - partInstance
      - pieceInstance
      - unknown

  NotificationTargetRundown:
    type: object
    title: NotificationTargetRundown
    required: [type, studioId, rundownId]
    properties:
      type:
        $ref: '#/$defs/NotificationTargetType'
        enum: [rundown]
      studioId:
        type: string
      rundownId:
        type: string
    additionalProperties: false
    examples:
      - type: rundown
        studioId: studio01
        rundownId: rd123

  NotificationTargetRundownPlaylist:
    type: object
    title: NotificationTargetRundownPlaylist
    required: [type, studioId, playlistId]
    properties:
      type:
        $ref: '#/$defs/NotificationTargetType'
        enum: [playlist]
      studioId:
        type: string
      playlistId:
        type: string
    additionalProperties: false
    examples:
      - type: playlist
        studioId: studio01
        playlistId: pl456

  NotificationTargetPartInstance:
    type: object
    title: NotificationTargetPartInstance
    required: [type, studioId, rundownId, partInstanceId]
    properties:
      type:
        $ref: '#/$defs/NotificationTargetType'
        enum: [partInstance]
      studioId:
        type: string
      rundownId:
        type: string
      partInstanceId:
        type: string
    additionalProperties: false
    examples:
      - type: partInstance
        studioId: studio01
        rundownId: rd123
        partInstanceId: pi789

  NotificationTargetPieceInstance:
    type: object
    title: NotificationTargetPieceInstance
    required: [type, studioId, rundownId, partInstanceId, pieceInstanceId]
    properties:
      type:
        $ref: '#/$defs/NotificationTargetType'
        enum: [pieceInstance]
      studioId:
        type: string
      rundownId:
        type: string
      partInstanceId:
        type: string
      pieceInstanceId:
        type: string
    additionalProperties: false
    examples:
      - type: pieceInstance
        studioId: studio01
        rundownId: rd123
        partInstanceId: pi789
        pieceInstanceId: pc1011

  NotificationTargetUnknown:
    type: object
    title: NotificationTargetUnknown
    required: [type]
    properties:
      type:
        $ref: '#/$defs/NotificationTargetType'
        enum: [unknown]
    additionalProperties: false
    examples:
      - type: unknown
